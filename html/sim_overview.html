<!-- HTML header for doxygen 1.9.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NASA Astrobee Robot Software: Simulator usage instructions for non-NASA users</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.png" type="image/png" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="freeflyer.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 70px;">
  <td id="projectlogo"><img alt="Logo" src="astrobee-logo.png" height="100"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NASA Astrobee Robot Software
   &#160;<span id="projectnumber">0.12.0</span>
   </div>
   <div id="projectbrief">Flight software for the Astrobee robot operating inside the International Space Station.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('sim_overview.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Simulator usage instructions for non-NASA users </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This documentation assumes you have followed the <a class="el" href="md_INSTALL.html">install readme</a>.</p>
<h2><a class="anchor" id="autotoc_md382"></a>
Setting up your Environment</h2>
<p>You will need to setup your environment so that ROS knows about the new packages provided by Astrobee flight software: </p><pre class="fragment">pushd $BUILD_PATH
source devel/setup.bash
popd
</pre><p>After this command has completed, you should be able to run <code>ros</code> commands from any directory in your Linux filesystem.</p>
<h2><a class="anchor" id="autotoc_md383"></a>
Running the Simulator</h2>
<p>To start a simulation of a single Astrobee docked in the ISS, run the following: </p><pre class="fragment">roslaunch astrobee sim.launch dds:=false robot:=sim_pub rviz:=true
</pre><ul>
<li>Note 1: The very first time Gazebo starts, it could take a long time because it loads some large models</li>
<li>Note 2: To run the simulation with the Gazebo rendering, you can add the flag <code>sviz:=true</code>. This allows one to see the ISS module used for the simulation. However this is resource intensive.</li>
</ul>
<p>This command tells ROS to look for the <code>sim.launch</code> file provided by the <code>astrobee</code> package, and use roslaunch to run it. Internally, ROS maintains a cache of information about package locations, libraries and executables. If you find that the above command doesn't work, try rebuilding the cache: </p><pre class="fragment">rospack profile
</pre><p>This command launches both the world and Astrobee. There are things in the world that need to be started up before Astrobee is started up. There is a small chance that this will not happen and the user will experience issues upon start up. If this happens, please see the <a href="#issues-starting-up-the-simulator">Issues Starting up the Simulator</a> section.</p>
<p><b>Important</b>: If you experience issues with the simulator and commanding the robot, please see the <a href="#simulator-issues">Simulator Issues</a> section before contacting the Astrobee team.</p>
<h3><a class="anchor" id="autotoc_md384"></a>
Simulator Flags</h3>
<p>There are many options when launching the simulator. This section will take you through the options we think are important to external users. If you are happy with the simulator setup from above, you can skip this section and jump to the <a href="#moving-the-robot">Moving the Robot</a> section.</p>
<p><b>Important</b>: You can specify more than one flag meaning you could launch more than one of the GUIs we offer. The simulator is very resource intensive. The more GUIs running, the more likely it is that you will get tolerance violation errors when you try to move. If you are running a virtual machine, please make sure that it has access to your graphics card.</p>
<h4><a class="anchor" id="autotoc_md385"></a>
pose</h4>
<p>This is the pose/location that Astrobee starts up at. The first 3 values are position and the last 4 are the orientation expressed as a quaternion. By default, the Astrobee starts up docked in the JEM module of the ISS. To start up in the middle of the JEM, run the following: </p><pre class="fragment">roslaunch astrobee sim.launch dds:=false robot:=sim_pub rviz:=true pose:="11.25 -6.95 4.49 0 0 0 1"
</pre><h4><a class="anchor" id="autotoc_md386"></a>
gds</h4>
<p>This flag is used to start up our ground data system (GDS). Currently, external users do not have access to GDS. Please see the <a href="#ground-data-system">Ground Data System</a> section for more information. GDS is the least computationally intensive GUI out of the 3 we offer and it is the only GUI that allows users to send commands. Thus we would prefer it if users use GDS when it is released to the public.</p>
<h4><a class="anchor" id="autotoc_md387"></a>
rviz</h4>
<p>This flag is used to start up the ros visualization system also known as RVIZ. RVIZ is our second most computationally intensive GUI. If you don't have access to GDS, we recommend using RVIZ to visualize what the robot is doing.</p>
<p><em>Note: <code>rviz</code> displays the robot perception of the world (estimated pose, sensor measurements, etc.).</em></p>
<h4><a class="anchor" id="autotoc_md388"></a>
sviz</h4>
<p>This flag is used to start up the Gazebo GUI. This GUI is the most computationally intensive GUI we have. We recommend using this GUI if you have a high performance machine.</p>
<p><em>Note: <code>sviz</code> displays the model of the world (ground truth). This means that the position represented in rviz or gds can differ from the position in sviz.</em></p>
<h4><a class="anchor" id="autotoc_md389"></a>
dds</h4>
<p>This flag is used to tell ROS if it should start the DDS ROS bridge. This bridge basically translates ROS to DDS and vice versa. DDS is used to communicate with our GDS. Since GDS is not available to external users, please always set the dds flag to false.</p>
<h4><a class="anchor" id="autotoc_md390"></a>
speed</h4>
<p>This flag is the speed multiplier for the simulator. By default, it is set to 1 meaning the simulator runs in real time. If you are having issues with simulator performance, you can slow the simulator down by specifying a value less than one. For example, the following would slow the simulator down to half speed: </p><pre class="fragment">roslaunch astrobee sim.launch dds:=false robot:=sim_pub rviz:=true speed:=0.5
</pre><p>If you have a high performance machine, you can speed up the simulator by specifying a value greater than 1. Please note, if you specify a speed up greater than what your computer can handle, the simulator will not run at the speed you specified. In this case, you can run gz stats in another terminal to figure out what the actual speed up is. If the factor in gz stats doesn't match the speed you specified, you can expect weird simulator issues.</p>
<h4><a class="anchor" id="autotoc_md391"></a>
ns</h4>
<p>This flag is the namespace of the simulated Astrobee. If you want to know more about ROS namespaces, please see the ROS documentation. This flag is only needed when running multiple robots in simulation. Please see the <a href="#launching-multiple-robots">Launching Multiple Robots</a> section for more information. The default namespace is blank.</p>
<p><b>Important</b>: We only support 4 namespaces in simulation; the blank namespace, honey, bumble, and queen. Please DO NOT capitalize the namespace as our GUIs don't support this.</p>
<h4><a class="anchor" id="autotoc_md392"></a>
robot</h4>
<p>This flag tells the flight software which configuration file to read. Since external users don't have access to our GDS and thus don't run our dds ros bridge, we have created a sim_pub configuration so that the system doesn't complain about the missing bridge. Until GDS is public, please always set this flag to sim_pub.</p>
<h4><a class="anchor" id="autotoc_md393"></a>
default</h4>
<p>This flag tells ROS to launch the default robot into the world. If you want to launch the world without the default robot, please set this to <code>false</code> (see the <a class="el" href="md_simulation_readme.html">developers simulator introduction</a> for an example).</p>
<h4><a class="anchor" id="autotoc_md394"></a>
world</h4>
<p>This flag tells ROS which world to launch. There are 2 Astrobee worlds; the ISS and the granite lab (a model of the actual testbed at Ames). By default, this is set to the ISS world. If you want to test in the granite lab, you will have to set up the robot for a world with gravity. To do this, first launch the simulation using the following: </p><pre class="fragment">roslaunch astrobee sim.launch dds:=false robot:=sim_pub rviz:=true world:="granite"
</pre><p>After the simulator is launched, you will have to reset the bias as we encode gravity in our bias. Please see the Reset Bias section of the <a href="../management/executive/teleop_tool.md#reset-bias">teleop tool readme</a> for instructions on how to send the reset bias command. After you do this, the robot should be stable. If you want to go back to using the ISS world, you will have to issue another reset bias command after launching the robot in the ISS world.</p>
<h4><a class="anchor" id="autotoc_md395"></a>
debug</h4>
<p>The Astrobee flight software is still in development and there are bugs that we don't always catch. If you come across a bug that crashes the flight software, please help us fix it. To help us, we need to know what happened. The crashed output should state the node that caused the crash. If it isn't clear which node it was, please email us the output and we can help. Once you have the name of the node, please set the debug flag to the node name. This flag will cause a GNU Debugger(GDB) terminal to pop up. Once the code crashes, navigate to the GDB terminal, type <code>bt</code>, and hit enter. This should display a backtrace. Please copy the backtrace and send it to us. Here is an example of launching the simulator and debugging the executive node: </p><pre class="fragment">roslaunch astrobee sim.launch dds:=false robot:=sim_pub rviz:=true debug:="executive" 
</pre><h2><a class="anchor" id="autotoc_md396"></a>
Moving the Robot</h2>
<p>There are currently 3 ways to move the robot in simulation.</p>
<h3><a class="anchor" id="autotoc_md397"></a>
Ground Data System</h3>
<p>The Ground Data System or GDS is our control station. It sends commands to Astrobee and displays telemetry from Astrobee. Using GDS is the preferred way to for an operator to operate Astrobee. However, GDS isn't currently open sourced. Thus as an external user, you will not be able to use it until it is open sourced.</p>
<h3><a class="anchor" id="autotoc_md398"></a>
Teleop Tool</h3>
<p>A teleop tool has been added to allow you to issue some commands and get some telemetry from the robot. This should only be used to play with the simulator and get a feel for how Astrobee works. As an external user, we consider you to be a guest scientist and we expect you to follow the guest science framework we have created. Please see the <a href="#guest-science-applications">Guest Science Applications</a> section for more information.</p>
<p>For information on how to use the teleop tool, please see the <a class="el" href="teleop__tool_8md.html">teleop tool instructions</a>.</p>
<h3><a class="anchor" id="autotoc_md399"></a>
Guest Science Applications</h3>
<p>If you are a guest scientist, please make sure you have the astrobee_android NASA GitHub project checked out (if you followed the usage instructions, you should have checked this out already). For more information on guest science and how to create guest science applications, please see <a href="https://github.com/nasa/astrobee_android/blob/master/README.md"><code>astrobee_android/readme.md</code></a> located in the <code>astrobee_android/</code> folder.</p>
<h2><a class="anchor" id="autotoc_md400"></a>
Images</h2>
<p>When running RVIZ, you may notice the big "No Image" text in the two <code>DEBUG</code> windows that are meant to show camera information. This is because, by default, we don't publish simulated camera images for the navigation and dock cameras due to the fact that simulating these images is very resource intensive. If you do want to generate these images, please open <code>astrobee/config/simulation/simulation.config</code> and change one or more of <code>nav_cam_rate</code> and <code>dock_cam_rate</code> to something other than 0. We recommend setting these values to 1 meaning these images will be published once per second. After this, you should see those images when you start the simulator. Please note this only works when the namespace is blank. If you want to see these images, please don't use the ns flag when launching the simulator. To show sci camera images, modify analogously the <code>sci_cam_rate</code> field, and enable this camera from the <code>Panels</code> menu in RVIZ.</p>
<p><b>Important</b> Unless you have a high performance machine, there is a good chance that these images will not initialize properly and you will be looking at the inside of the robot. If this happens, you will need to launch the world and Astrobee separately. Please follow the <a href="#issues-starting-up-the-Simulator">Issues Starting up the Simulator</a> section with one caveat. DO NOT start up Astrobee (i.e. don't issue the second terminal command) until 30 to 40 seconds after RVIZ has started up. If you have a low performance computer, this fix may not be the only thing you have to do to fix the images. Please try reducing the speed of your simulator as well. For information on how to reduce the simulator speed, please see the <a href="#speed">speed</a> flag section.</p>
<h2><a class="anchor" id="autotoc_md401"></a>
Launching Multiple Robots</h2>
<p>Coming soon!!!</p>
<h2><a class="anchor" id="autotoc_md402"></a>
Simulator Issues</h2>
<p><a class="el" href="sim__issues_8md.html">List of common issue with the simulator</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.0-->
<!-- start footer part -->
</body>
</html>
